(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{135:function(e,t,n){"use strict";n.r(t);var a,r=n(157),s=n.n(r),i=(n(148),n(158)),o=n.n(i),c=n(6),l=n.n(c),m=n(47),u=n.n(m),d=(n(27),n(69),n(140)),h=n.n(d),f=(n(144),n(0)),p=n.n(f),v=n(176),y=n.n(v),g=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={data:void 0,isLoading:!1,error:void 0},n.fetch=n.fetch.bind(u()(u()(n))),n}l()(t,e);var n=t.prototype;return n.mergeData=function(e,t,n){return this.props.mergeData?this.props.mergeData(e,t,n):t},n.fetch=function(){var e=o()(s.a.mark(function e(t,n){var a,r=this;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({isLoading:!0}),e.prev=1,e.next=4,y.a.get(t);case 4:a=e.sent,this.setState(function(e){return{data:r.mergeData(e.data,a.data,n),isLoading:!1}}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this.setState({error:e.t0,isLoading:!1});case 11:case"end":return e.stop()}},e,this,[[1,8]])}));return function(t,n){return e.apply(this,arguments)}}(),n.render=function(){var e=this.props.component;return p.a.createElement(e,Object.assign({},this.props,this.state,{fetch:this.fetch}))},t}(p.a.Component),E=n(196),w=n.n(E),N=function(e){var t=e.dateTime;return(t instanceof Date?t:new Date(t)).toLocaleDateString()},D=function(e){var t=e.dateTime;return(t instanceof Date?t:new Date(t)).toLocaleTimeString()},b=n(197),k=function(e){var t=e.track,n=e.album,a=e.artist,r=e.listenedAt,s=e.key,i=e.style;return p.a.createElement(b.b.tr,{className:"listen",style:i,key:s},p.a.createElement("td",{className:"track"},t.name),p.a.createElement("td",{className:"album"},n.name),p.a.createElement("td",{className:"artist"},a.name),p.a.createElement("td",{className:"listened-at"},p.a.createElement(D,{dateTime:r})))},S=function(e,t){var n=864e5*t;return new Date(e.getTime()-n)},x=function(e){var t=new Date(e.getTime());return t.setHours(0,0,0,0),t},T=function(e){var t=e.style,n=e.key;return p.a.createElement(b.b.tr,{style:t,key:n,className:"align-center"},p.a.createElement("td",{colSpan:"4",className:"big-emoji"},"🙅🏻‍♂️🙅🏻‍♂️🙅🏻‍♂️"))},L=function(e){var t=e.style,n=e.day;return p.a.createElement(b.b.tr,{style:t,key:n.date.toISOString(),className:"alt align-center"},p.a.createElement("td",{colSpan:"4"},p.a.createElement(N,{dateTime:n.date})))},A=function(e){var t=e.component,n=h()(e,["component"]),a=t;return p.a.createElement(a,n)},H=(a=function(e){var t=e.h1,n=e.ths,a=e.trs,r=e.footerTr,s=e.wrapperClass;return p.a.createElement("div",{id:"wrapper",className:"divided "+s},p.a.createElement("section",{className:"wrapper style1 align-center"},p.a.createElement("div",{className:"inner"},p.a.createElement("h1",null,t),p.a.createElement("div",{className:"index align-left"},p.a.createElement("section",null,p.a.createElement("div",{className:"content"},p.a.createElement("div",{className:"table-wrapper"},p.a.createElement("table",{className:"alt uniform"},p.a.createElement("thead",null,p.a.createElement("tr",null,n)),p.a.createElement("tbody",null,a),p.a.createElement("tfoot",null,r)))))))))},function(e){function t(t){var n;return(n=e.call(this,t)||this).handleScroll=w()(n.handleScroll.bind(u()(u()(n))),200),n}l()(t,e);var n=t.prototype;return n.componentDidMount=function(){window.addEventListener("scroll",this.handleScroll)},n.componentWillUnmount=function(){window.removeEventListener("scroll",this.handleScroll)},n.handleScroll=function(e){window.innerHeight+window.scrollY>=document.body.offsetHeight-500&&this.props.onHitBottom()},n.render=function(){return p.a.createElement(a,this.props)},t}(p.a.Component)),O=function(e){return e.key},C=function(e){function t(t){var n;return(n=e.call(this,t)||this).fetchNextDay=n.fetchNextDay.bind(u()(u()(n))),n}l()(t,e),t.mergeData=function(e,t,n){void 0===e&&(e=[]),void 0===t&&(t={});var a={date:n,listens:t.contents};return[].concat(e,[a])};var n=t.prototype;return n.componentDidMount=function(){var e=o()(s.a.mark(function e(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.fetchNextDay();case 2:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}(),n.fetchNextDay=function(){var e=o()(s.a.mark(function e(){var t,n,a,r,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return null==this.daysAgo?this.daysAgo=0:this.daysAgo+=1,this.endOfToday||(this.endOfToday=(s=new Date,o=void 0,(o=new Date(s.getTime())).setHours(23,59,59,999),o)),t=S(this.endOfToday,this.daysAgo),n=x(t),a=t.getTime(),r=n.getTime(),i="https://data.noisemachines.io/thomas/listens?from="+r+"&to="+a,e.next=9,this.props.fetch(i,n);case 9:window.innerHeight+window.scrollY>=document.body.offsetHeight-500&&this.fetchNextDay();case 10:case"end":return e.stop()}var s,o},e,this)}));return function(){return e.apply(this,arguments)}}(),n.render=function(){var e=this.props,t=e.data,n=(e.isLoading,[]);(t||[]).forEach(function(e){var t=function(e){var t=[];if(t.push({component:L,day:e,key:e.date.toISOString()}),0===e.listens.length){var n=e.date.toISOString()+"-no-listens";t.push({component:T,key:n})}else e.listens.forEach(function(e){var n,a,r,s,i,o=(a=(n=e).track,r=n.album,s=n.artist,i=n.listenedAt,a.name+"-"+r.name+"-"+s.name+"-"+i);t.push(Object.assign({component:k,key:o},e))});return t}(e);n=n.concat(t)});var a=p.a.createElement(b.a,{native:!0,items:n,keys:O,from:{opacity:0,transform:"translate3d(-40px,0,0)"},enter:{opacity:1,transform:"translate3d(0,0px,0)"},leave:{opacity:0,transform:"translate3d(-40px,0,0)"},trail:100},function(e){return function(t){return p.a.createElement(A,Object.assign({style:t},e))}}),r=p.a.createElement(p.a.Fragment,null,p.a.createElement("th",{className:"track"},"Song"),p.a.createElement("th",{className:"album"},"Album"),p.a.createElement("th",{className:"artist"},"Artist"),p.a.createElement("th",{className:"listened-at"},"ListenedAt"));return p.a.createElement(p.a.Fragment,null,p.a.createElement(H,{h1:"Listening History 🎧",ths:r,trs:a,wrapperClass:"listening-history",onHitBottom:this.fetchNextDay}))},t}(p.a.Component);t.default=function(){return p.a.createElement(g,{component:C,mergeData:C.mergeData})}}}]);
//# sourceMappingURL=component---src-pages-thomas-listens-js-fb88b2f9898651ca9f96.js.map